<div class="modal container">
    <div class="modal-header">
        <h1><i class="icon-pencil"></i> Editing step : &lt;<strong>{{ formStep.name }}</strong>&gt;</h1>
    </div>

    <div class="modal-body">
        <form novalidate name="stepForm" id="stepForm">
            <fieldset class="row-fluid">
                <div class="control-group span3">
                    <label for="step-name" class="control-label">Name</label>
                    <input type="text" id="step-name" ng-model="formStep.name" value="{{ formStep.name }}" required />
                </div>
                
                <div class="control-group span3">
                    <label for="step-who" class="control-label">Who ?</label>
                    <select name="step-who" id="step-who" ng-model="formStep.who">
                        <option value=""></option>
                        <option value="student">Student</option>
                        <option value="group">Group</option>
                        <option value="class">Class</option>
                    </select>
                </div>
                
                <div class="control-group span3">
                    <label for="step-where" class="control-label">Where ?</label>
                    <select name="step-where" id="step-where" ng-model="formStep.where">
                        <option value=""></option>
                        <option value="home">Home</option>
                        <option value="classroom">Classroom</option>
                        <option value="library">Library</option>
                        <option value="anywhere">Anywhere</option>
                    </select>
                </div>
                
                <div class="step-duration control-group span3">
                    <label for="step-duration-hours" class="control-label">Student duration (in hours)</label>
                    <select class="span3" name="step-duration-hours" id="step-duration-hours" ng-model="formStep.durationHours">
                        <option value="">00</option>
                        <option value="1">01</option>
                        <option value="2">02</option>
                        <option value="3">03</option>
                        <option value="4">04</option>
                        <option value="5">05</option>
                        <option value="6">06</option>
                        <option value="7">07</option>
                        <option value="8">08</option>
                        <option value="9">09</option>
                        <option value="10">10</option>
                    </select>
                    <span>h</span>
                    <select class="span3" name="step-duration-minutes" id="step-duration-minutes" ng-model="formStep.durationMinutes">
                        <option value="">00</option>
                        <option value="5">05</option>
                        <option value="10">10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                        <option value="25">25</option>
                        <option value="30">30</option>
                        <option value="35">35</option>
                        <option value="40">40</option>
                        <option value="45">45</option>
                        <option value="50">50</option>
                        <option value="55">55</option>
                    </select>
                    <span>min</span>
                </div>
                
                <div class="control-group span3 offset3">
                    <label class="checkbox">
	                    <input type="checkbox" name="with-tutor" id="with-tutor" ng-model="formStep.withTutor" />
	                    With tutor ?
	                </label>
                </div>
                
                <div class="control-group span3">
                    <label class="checkbox">
                        <input type="checkbox" name="with-computer" id="with-computer" ng-model="formStep.withComputer" />
                        With computer ?
                    </label>
                </div>
                
                <div class="control-group span8 offset2">
	                <textarea class="span10" id="step-instructions" name="step-instructions" ng-model="formStep.instructions" placeholder="Tip step instructions here">{{ formStep.instructions }}</textarea>
                </div>
            </fieldset>
        </form>

        <div class="row-fluid">
            <div class="panel-documents well well-small span4">
                <button class="btn btn-mini btn-primary pull-left" ng-click="editResource('document')"><i class="icon-plus"></i></button>
                <h2>Documents <i class="icon-briefcase"></i></h2>
                <div ng-include="'partials/resource-list.html'" onload="activeTab = 'Global'"></div>
                <table class="table table-condensed table-hover">
                    <!-- Inherited documents from parents -->
                    <tr ng-repeat="resource in inheritedResources | filter: {type: 'document'}">
                        <td class="icon"><img src="images/icons/document/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td ng-class="{'excluded-resource': resource.isExcluded}">&lt;<strong>{{ resource.parentStep }}</strong>&gt; {{ resource.name }}</td>
                        <td class="actions">
                            <button ng-show="resource.isExcluded" class="btn btn-mini btn-success" ng-click="includeParentResource(resource)" tooltip="Enable document for this step"><i class="icon-ok"></i></button>
                    <button ng-show="!resource.isExcluded" class="btn btn-mini btn-danger" ng-click="excludeParentResource(resource)" tooltip="Disable document for this step"><i class="icon-remove"></i></button>
                        </td>
                    </tr>
                    
                    <!-- Specific documents -->
                    <tr ng-repeat="resource in formStep.resources | filter: {type: 'document'}">
                        <td class="icon"><img src="images/icons/document/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td>{{ resource.name }}</td>
                        <td class="actions">
                            <button class="btn btn-mini" ng-click="editResource('document', resource)" tooltip="Edit"><i class="icon-edit"></i></button>
                            <button class="btn btn-mini btn-danger" ng-click="removeResource(resource)" tooltip="Delete"><i class="icon-trash"></i></button>
                        </td>
                    </tr>
                </table>
            </div>
            
            <div class="panel-image well well-small span4">
               <div>
                    <img src="images/image.png" />
               </div>
               <br/>
               <button class="btn btn-small" ng-click="selectImage()"><i class="icon-picture"></i> Select image</button>
            </div>
            
            <div class="panel-tools well well-small span4">
                <button class="btn btn-mini btn-primary pull-right" ng-click="editResource('tool')"><i class="icon-plus"></i></button>
                <h2><i class="icon-wrench"></i> Tools</h2>
                <table class="table table-condensed table-hover">
                    <!-- Inherited tools from parents -->
                    <tr ng-repeat="resource in inheritedResources | filter: {type: 'tool'}">
                        <td class="icon"><img src="images/icons/tool/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td ng-class="{'excluded-resource': resource.isExcluded}">&lt;<strong>{{ resource.parentStep }}</strong>&gt; {{ resource.name }}</td>
                        <td class="actions">
                            <button ng-show="resource.isExcluded" class="btn btn-mini btn-success" ng-click="includeParentResource(resource)" tooltip="Enable tool for this step"><i class="icon-ok"></i></button>
                            <button ng-show="!resource.isExcluded" class="btn btn-mini btn-danger" ng-click="excludeParentResource(resource)" tooltip="Disable tool for this step"><i class="icon-remove"></i></button>
                        </td>
                    </tr>
                    
                    <!-- Specific tools -->
                    <tr ng-repeat="resource in formStep.resources | filter: {type: 'tool'}">
                        <td class="icon"><img src="images/icons/tool/16x16/{{ resource.subType }}.png" alt="{{ resource.subType }}" /></td>
                        <td>{{ resource.name }}</td>
                        <td class="actions">
                            <button class="btn btn-mini" ng-click="editResource('tool', resource)" tooltip="Edit"><i class="icon-edit"></i></button>
                            <button class="btn btn-mini btn-danger" ng-click="removeResource(resource)" tooltip="Delete"><i class="icon-trash"></i></button>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <button class="btn btn-warning cancel" ng-click="close()" ng-disabled="buttonsDisabled">Cancel</button>
        <button class="btn btn-primary" ng-click="save(formStep)" ng-disabled="buttonsDisabled || !stepForm.$valid">Save step</button>
    </div>
</div>